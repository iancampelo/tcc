package br.com.ucb.dao;

import java.sql.Connection;
import java.sql.DriverManager;


import java.sql.PreparedStatement;

import br.com.ucb.factory.ConnectionFactory;
import br.com.ucb.modelo.Projeto;
import br.com.ucb.modelo.Usuario;

public class ProjetoDao extends ConnectionFactory{

	private static ProjetoDao instancia = null;
	
	public static ProjetoDao getInstancia(){
		if (instancia == null){
			instancia = new ProjetoDao();
		}
		return instancia;
	}
	
	public boolean inserir (Usuario user, Projeto proj){
		
		Connection conn      = null;
		PreparedStatement ps = null;
		
		String sql = "insert into projeto(uid,nome,tempo_estimado,kma) "+
					 "values (?,?,?,?,?,?)";
		try{
			conn = criarConexao();
			ps = conn.prepareStatement(sql);
			
			ps.setInt   (1, user.getId           ());
			ps.setString(2, proj.getNome         ());
			ps.setFloat (3, proj.getTempoEstimado());
			ps.setFloat (4, proj.getKma          ());
			
			return ps.execute();
			
		}catch(Exception e){
			System.out.println("Erro ao inserir projeto: "+e);
			e.printStackTrace();
			return false;
		}finally{
			fecharConexao(conn, ps, null);
		}
	}
	
	public boolean excluir (Projeto proj){
		Connection conn 	 = null;
		PreparedStatement ps = null;
		
		String sql = "delete from projeto where id = ?";
		
		try{
			conn = criarConexao();
			ps = conn.prepareStatement(sql);
			
			ps.setInt(1, proj.getId());
			
			return ps.execute();
			
		}catch(Exception e){
			System.out.println("Erro ao excluir projeto: "e);
			e.printStackTrace();
			return false;
		}finally{
			fecharConexao(conn, ps, null);
		}
	}
}




